"use strict";angular.module("movieappApp",["ngAnimate","ngSanitize","ui.select","ui.router","angularMoment","formio","ngMap"]).config(["$stateProvider","$urlRouterProvider","FormioProvider","AppConfig",function(a,b,c,d){c.setBaseUrl(d.apiUrl),a.state("home",{url:"/?",templateUrl:"views/main.html"}).state("auth",{"abstract":!0,url:"/auth",templateUrl:"views/user/auth.html"}).state("auth.login",{url:"/login",parent:"auth",templateUrl:"views/user/login.html",controller:["$scope","$state","$rootScope",function(a,b,c){a.$on("formSubmission",function(a,d){d&&(c.user=d,b.go("home"))})}]}).state("auth.register",{url:"/register",parent:"auth",templateUrl:"views/user/register.html",controller:["$scope","$state","$rootScope",function(a,b,c){a.$on("formSubmission",function(a,d){d&&(c.user=d,b.go("home"))})}]}).state("movieIndex",{url:"/movie",templateUrl:"views/movie/index.html",controller:["$scope","$state",function(a,b){a.$on("submissionView",function(a,c){b.go("movie.view",{movieId:c._id})}),a.$on("submissionEdit",function(a,c){b.go("movie.edit",{movieId:c._id})}),a.$on("submissionDelete",function(a,c){b.go("movie.delete",{movieId:c._id})})}]}).state("createMovie",{url:"/create/movie",templateUrl:"views/movie/create.html",controller:["$scope","$state",function(a,b){a.$on("formSubmission",function(a,c){b.go("movie.view",{movieId:c._id})})}]}).state("movie",{"abstract":!0,url:"/movie/:movieId",templateUrl:"views/movie/movie.html",controller:["$scope","$stateParams",function(a,b){a.movieUrl=a.movieForm+"/submission/"+b.movieId}]}).state("movie.view",{url:"/",parent:"movie",templateUrl:"views/movie/view.html",controller:["$scope","$stateParams","Formio",function(a,b,c){var d=new c(a.movieForm+"/submission/"+b.movieId);a.movie={},d.loadSubmission().then(function(b){a.movie=b})}]}).state("movie.edit",{url:"/edit",parent:"movie",templateUrl:"views/movie/edit.html",controller:["$scope","$state",function(a,b){a.$on("formSubmission",function(a,c){b.go("movie.view",{movieId:c._id})})}]}).state("movie.delete",{url:"/delete",parent:"movie",templateUrl:"views/movie/delete.html",controller:["$scope","$state",function(a,b){a.$on("delete",function(){b.go("movieIndex")})}]}).state("directorIndex",{url:"/director",templateUrl:"views/director/index.html",controller:["$scope","$state",function(a,b){a.$on("submissionView",function(a,c){b.go("director.view",{directorId:c._id})}),a.$on("submissionEdit",function(a,c){b.go("director.edit",{directorId:c._id})}),a.$on("submissionDelete",function(a,c){b.go("director.delete",{directorId:c._id})})}]}).state("createDirector",{url:"/create/director",templateUrl:"views/director/create.html",controller:["$scope","$state",function(a,b){a.$on("formSubmission",function(a,c){b.go("director.view",{directorId:c._id})})}]}).state("director",{"abstract":!0,url:"/director/:directorId",templateUrl:"views/director/director.html",controller:["$scope","$stateParams",function(a,b){a.directorUrl=a.directorForm+"/submission/"+b.directorId}]}).state("director.view",{url:"/",parent:"director",templateUrl:"views/director/view.html",controller:["$scope","$stateParams","Formio",function(a,b,c){var d=new c(a.directorForm+"/submission/"+b.directorId);a.director={},a.position={lat:"40.74",lng:"-74.18"},d.loadSubmission().then(function(b){a.position.lat=b.data.address.geometry.location.lat,a.position.lng=b.data.address.geometry.location.lng,a.director=b})}]}).state("director.edit",{url:"/edit",parent:"director",templateUrl:"views/director/edit.html",controller:["$scope","$state",function(a,b){a.$on("formSubmission",function(a,c){b.go("director.view",{directorId:c._id})})}]}).state("director.delete",{url:"/delete",parent:"director",templateUrl:"views/director/delete.html",controller:["$scope","$state",function(a,b){a.$on("delete",function(){b.go("directorIndex")})}]}),b.otherwise("/")}]).run(["$state","$rootScope","Formio","AppConfig",function(a,b,c,d){b.userLoginForm=d.appUrl+"/user/login",b.userRegisterForm=d.appUrl+"/user/register",b.movieForm=d.appUrl+"/movie",b.directorForm=d.appUrl+"/director",b.user||c.currentUser().then(function(a){b.user=a}),b.$on("$stateChangeStart",function(d,e){b.authenticated=!!c.getToken(),"auth"!==e.name.substr(0,4)&&(b.authenticated||(d.preventDefault(),a.go("auth.login")))});var e=function(){a.go("home")},f=function(){a.go("auth.login")};b.$on("formio.sessionExpired",f),b.$on("formio.unauthorized",e),b.logout=function(){c.logout().then(function(){a.go("auth.login")})["catch"](f)},b.isActive=function(b){return-1!==a.current.name.indexOf(b)}}]).directive("youtube",function(){return{restrict:"E",scope:{src:"="},templateUrl:"views/youtube.html"}}).filter("trusted",["$sce",function(a){return function(b){return a.trustAsResourceUrl(b)}}]),angular.module("movieappApp").controller("MainCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]);